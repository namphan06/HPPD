<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Ch√∫c M·ª´ng Sinh Nh·∫≠t üéâ</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <style>
      body {
        margin: 0;
        font-family: "Segoe UI", sans-serif;
        background: linear-gradient(135deg, #ffe0f0, #e0e7ff, #fff9c4);
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
      }
      .card {
        border-radius: 20px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
      }
      h1,
      h2 {
        color: #d6336c;
      }
      p {
        color: #333;
        line-height: 1.6;
      }
      .hidden {
        display: none;
      }

      /* ‚ú® Hi·ªáu ·ª©ng trang */
      .page {
        animation: slideDown 0.7s ease;
      }
      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-40px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* üéÇ B√°nh */
      .cake-container {
        position: relative;
        display: inline-block;
      }
      .cake {
        width: 250px;
        max-width: 100%;
      }
      .flame {
        position: absolute;
        top: 20px;
        left: 52%;
        transform: translateX(-50%);
        width: 30px;
        z-index: 2;
      }
      .smoke {
        position: absolute;
        top: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 20px;
        height: 60px;
        background: linear-gradient(
          to top,
          rgba(128, 128, 128, 0.5),
          transparent
        );
        border-radius: 50%;
        animation: smokeUp 2s ease-out forwards;
      }
      @keyframes smokeUp {
        0% {
          opacity: 1;
          transform: translateX(-50%) translateY(0);
        }
        100% {
          opacity: 0;
          transform: translateX(-50%) translateY(-80px);
        }
      }

      /* ‚ú® Hi·ªáu ·ª©ng ch·ªØ */
      .title {
        font-size: 2.5rem;
        text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.3);
        animation: glow 2s infinite alternate;
      }
      @keyframes glow {
        from {
          color: #d6336c;
        }
        to {
          color: #ff8fa3;
        }
      }

      /* üéÅ H·ªôp qu√† */
      /* üéÅ H·ªôp qu√† */
      .gift-box {
        font-size: 5rem;
        cursor: pointer;
        margin: 40px auto;
        animation: bounce 1.5s infinite;
      }
      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-15px);
        }
      } /* Overlay cho qu√† */
      .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 100;
      }
      .overlay.hidden {
        display: none;
      }
      .overlay-content {
        text-align: center;
        color: #fff;
        padding: 20px;
        animation: fadeIn 1s;
      }
      .overlay-content h2 {
        font-size: 1.8rem;
        margin-bottom: 20px;
      }
      .overlay button {
        padding: 10px 20px;
        font-size: 1rem;
        background: #ff69b4;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: 0.3s;
      }
      .overlay button:hover {
        background: #ff1493;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      /* ·∫¢nh b·∫•t ng·ªù */
      .surprise {
        max-width: 250px;
        border-radius: 15px;
        box-shadow: 0 8px 25px rgba(255, 105, 180, 0.6);
        animation: popIn 1s ease forwards, pulse 1.5s infinite alternate;
      }

      /* Hi·ªáu ·ª©ng bung ra */
      @keyframes popIn {
        0% {
          transform: scale(0) rotate(-30deg);
          opacity: 0;
        }
        70% {
          transform: scale(1.2) rotate(10deg);
          opacity: 1;
        }
        100% {
          transform: scale(1) rotate(0);
        }
      }

      /* Nh·ªãp ƒë·∫≠p nh·∫π */
      @keyframes pulse {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(1.05);
        }
      }

      /* Fireworks canvas */
      #fireworks {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <div class="container my-4">
      <div class="card shadow-lg p-4 text-center">
        <!-- Trang 1 -->
        <div class="page" id="page1">
          <h1 class="title">üéâ Ch√∫c M·ª´ng Sinh Nh·∫≠t üéâ</h1>
          <p class="subtitle">
            üî• Qu√† si√™u c·∫•p ƒë√°ng y√™u ƒëang ·∫©n trong h·ªôp qu√† b√™n d∆∞·ªõi, m·ªü li·ªÅn tay
            ƒëi n√†o!
          </p>
          <div class="gift-box mx-auto" onclick="openGift()">üéÅ</div>
          <button
            id="musicBtn"
            onclick="toggleMusic()"
            class="btn btn-danger mt-3"
          >
            üéµ B·∫≠t/T·∫Øt nh·∫°c
          </button>
        </div>

        <!-- Overlay -->
        <!-- Overlay -->
        <div id="gift-overlay" class="overlay hidden">
          <div class="overlay-content">
            <canvas id="fireworks"></canvas>
            <!-- ·∫¢nh b·∫•t ng·ªù -->
            <img
              src="image/hppd-cartoon.png"
              id="surprise-img"
              class="surprise hidden"
              alt="Surprise"
            />
            <h2 id="surprise-text" class="hidden">
              ‚ú® Ch√∫c b·∫°n sinh nh·∫≠t ng·∫≠p tr√†n h·∫°nh ph√∫c ‚ú®
            </h2>
            <button onclick="closeOverlay()">Ti·∫øp t·ª•c</button>
          </div>
        </div>

        <!-- Trang 2 -->
        <div class="page hidden" id="page2">
          <h2>üíå L·ªùi ch√∫c ƒë·∫∑c bi·ªát</h2>
          <p>
            Ch√∫c m·ª´ng sinh nh·∫≠t em y√™u c·ªßa anh! H√¥m nay l√† m·ªôt ng√†y th·∫≠t ƒë·∫∑c
            bi·ªát, v√¨ ƒë√≥ l√† ng√†y thi√™n th·∫ßn nh·ªè c·ªßa anh xu·∫•t hi·ªán tr√™n ƒë·ªùi. Anh
            ch√∫c em lu√¥n c√≥ th·∫≠t nhi·ªÅu s·ª©c kh·ªèe ƒë·ªÉ l√∫c n√†o c≈©ng tr√†n ƒë·∫ßy nƒÉng
            l∆∞·ª£ng v√† n·ª• c∆∞·ªùi t∆∞∆°i t·∫Øn. Anh mong s·ª± nghi·ªáp v√† nh·ªØng d·ª± ƒë·ªãnh c·ªßa
            em s·∫Ω ng√†y c√†ng thu·∫≠n l·ª£i, g·∫∑t h√°i nhi·ªÅu th√†nh c√¥ng v√† mang l·∫°i cho
            em ni·ªÅm t·ª± h√†o. Anh c≈©ng ch√∫c cho nhan s·∫Øc c·ªßa em s·∫Ω m√£i r·∫°ng ng·ªùi,
            xinh ƒë·∫πp, khi·∫øn tr√°i tim anh l√∫c n√†o c≈©ng ph·∫£i rung ƒë·ªông nh∆∞ l·∫ßn ƒë·∫ßu
            g·∫∑p g·ª°. V√† quan tr·ªçng nh·∫•t, anh mong r·∫±ng t√¨nh c·∫£m c·ªßa ch√∫ng ta s·∫Ω
            lu√¥n b·ªÅn ch·∫∑t, ng·ªçt ng√†o v√† ng√†y m·ªôt s√¢u ƒë·∫≠m h∆°n. Anh y√™u em r·∫•t
            nhi·ªÅu üíñüéÇüåπ.
          </p>
        </div>

        <!-- Trang 3 -->
        <div class="page hidden" id="page3">
          <h2>üéÇ B√°nh Sinh Nh·∫≠t</h2>
          <div class="cake-container">
            <img src="image/cake.png" class="cake img-fluid" alt="Cake" />
            <img
              src="image/flame-gif.webp"
              id="flame"
              class="flame hidden"
              alt="Flame"
            />
            <div id="smoke" class="smoke hidden"></div>
          </div>
          <div class="mt-3">
            <button onclick="lightCandle()" class="btn btn-warning">
              üî• Th·∫Øp n·∫øn
            </button>
          </div>
        </div>

        <!-- Trang 4 -->
        <div class="page hidden" id="page4">
          <h2>üéä Ch√∫c b·∫°n sinh nh·∫≠t vui v·∫ª! üéä</h2>
          <p>H√£y t·∫≠n h∆∞·ªüng ni·ªÅm vui h√¥m nay v√† c·∫£ nh·ªØng ng√†y s·∫Øp t·ªõi üíñ</p>
        </div>

        <!-- N√∫t ƒëi·ªÅu h∆∞·ªõng -->
        <div class="nav mt-4 d-flex justify-content-between">
          <button onclick="prevPage()" class="btn btn-outline-secondary">
            ‚¨Ö Tr∆∞·ªõc
          </button>
          <button onclick="nextPage()" class="btn btn-primary">Ti·∫øp ‚û°</button>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- üéµ & Hi·ªáu ·ª©ng -->
    <script>
      let currentPage = 1;
      const totalPages = 4;

      function showPage(n) {
        for (let i = 1; i <= totalPages; i++) {
          document.getElementById("page" + i).classList.add("hidden");
        }
        document.getElementById("page" + n).classList.remove("hidden");
      }
      function nextPage() {
        if (currentPage < totalPages) {
          currentPage++;
          showPage(currentPage);
        }
      }
      function prevPage() {
        if (currentPage > 1) {
          currentPage--;
          showPage(currentPage);
        }
      }

      function closeOverlay() {
        document.getElementById("gift-overlay").classList.add("hidden");

        // ·∫®n l·∫°i ƒë·ªÉ l·∫ßn sau m·ªü qu√† c√≤n hi·ªáu ·ª©ng
        document.getElementById("surprise-img").classList.add("hidden");
        document.getElementById("surprise-text").classList.add("hidden");

        nextPage(); // sang trang ti·∫øp theo
      }

      // üéÅ Gift overlay
      function openGift() {
        document.getElementById("gift-overlay").classList.remove("hidden");
        startFireworks();

        // Delay 0.5s cho c·∫£m gi√°c b·∫•t ng·ªù
        setTimeout(() => {
          document.getElementById("surprise-img").classList.remove("hidden");
        }, 500);

        // Hi·ªán ch·ªØ sau ·∫£nh
        setTimeout(() => {
          document.getElementById("surprise-text").classList.remove("hidden");
        }, 1200);
      }

      // üéµ Nh·∫°c
      let music = new Audio("hpbd-mp3.mp3");
      function toggleMusic() {
        if (music.paused) music.play();
        else music.pause();
      }

      // üéÇ N·∫øn
      function lightCandle() {
        document.getElementById("flame").classList.remove("hidden");
        document.getElementById("smoke").classList.add("hidden");
      }
      function blowCandle() {
        document.getElementById("flame").classList.add("hidden");
        const smoke = document.getElementById("smoke");
        smoke.classList.remove("hidden");
        setTimeout(() => smoke.classList.add("hidden"), 2000);
      }

      // üé§ Mic detect
      navigator.mediaDevices.getUserMedia({ audio: true }).then((stream) => {
        const ctx = new AudioContext();
        const source = ctx.createMediaStreamSource(stream);
        const analyser = ctx.createAnalyser();
        source.connect(analyser);
        const data = new Uint8Array(analyser.fftSize);

        function checkVolume() {
          analyser.getByteTimeDomainData(data);
          let sum = 0;
          for (let i = 0; i < data.length; i++) {
            let v = (data[i] - 128) / 128;
            sum += v * v;
          }
          let volume = Math.sqrt(sum / data.length);
          if (
            volume > 0.2 &&
            !document.getElementById("flame").classList.contains("hidden")
          ) {
            blowCandle();
          }
          requestAnimationFrame(checkVolume);
        }
        checkVolume();
      });

      // üéä Fireworks
      function startFireworks() {
        const canvas = document.getElementById("fireworks");
        const ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        let particles = [];

        function createParticle(x, y) {
          let angle = Math.random() * 2 * Math.PI;
          let speed = Math.random() * 5 + 2;
          return {
            x,
            y,
            vx: Math.cos(angle) * speed,
            vy: Math.sin(angle) * speed,
            alpha: 1,
            color: `hsl(${Math.random() * 360},100%,50%)`,
          };
        }

        function loop() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          if (Math.random() < 0.05) {
            let x = Math.random() * canvas.width;
            let y = (Math.random() * canvas.height) / 2;
            for (let i = 0; i < 30; i++) {
              particles.push(createParticle(x, y));
            }
          }
          particles.forEach((p, i) => {
            p.x += p.vx;
            p.y += p.vy;
            p.alpha -= 0.01;
            ctx.globalAlpha = p.alpha;
            ctx.fillStyle = p.color;
            ctx.beginPath();
            ctx.arc(p.x, p.y, 3, 0, Math.PI * 2);
            ctx.fill();
          });
          particles = particles.filter((p) => p.alpha > 0);
          requestAnimationFrame(loop);
        }
        loop();
      }

      showPage(currentPage);
    </script>
  </body>
</html>
